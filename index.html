<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<title>Painel de Investimento</title>
<style>
  body { font-family: Arial, sans-serif; margin: 20px; background: #f0f2f5; }
  h1 { color: #333; }
  label { display: block; margin-top: 10px; }
  input { padding: 6px; width: 150px; }
  button { margin-top: 15px; padding: 10px 15px; background: #007bff; color: white; border: none; cursor: pointer; }
  button:hover { background: #0056b3; }
  #resultado, #grafico { margin-top: 25px; }
</style>
</head>
<body>

<h1>Painel de Investimento Mensal</h1>

<label>Valor investido por m√™s (R$): 
  <input type="number" id="valorMes" value="800" min="1" step="any" />
</label>

<label>Rendimento mensal esperado (%): 
  <input type="number" id="rendimento" value="5" min="0" step="0.01" />
</label>

<label>Meta de renda mensal desejada (R$): 
  <input type="number" id="meta" value="1000" min="1" step="any" />
</label>

<button onclick="calcular()">Calcular proje√ß√£o</button>

<div id="resultado"></div>
<canvas id="grafico" width="600" height="300"></canvas>

<button id="btnWhats" style="display:none" onclick="enviarWhatsApp()">Enviar relat√≥rio pelo WhatsApp</button>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
const ctx = document.getElementById('grafico').getContext('2d');
let chart;

function calcular() {
  const valorMes = parseFloat(document.getElementById('valorMes').value);
  const rendimento = parseFloat(document.getElementById('rendimento').value) / 100;
  const meta = parseFloat(document.getElementById('meta').value);

  if (valorMes <= 0 || rendimento <= 0 || meta <= 0) {
    alert('Preencha todos os campos com valores positivos.');
    return;
  }

  let saldo = 0;
  let meses = 0;
  const saldos = [];
  const labels = [];

  // Calcula m√™s a m√™s at√© saldo gerar renda mensal >= meta
  while ((saldo * rendimento) < meta) {
    saldo = saldo * (1 + rendimento) + valorMes;
    meses++;
    labels.push('M√™s ' + meses);
    saldos.push(parseFloat(saldo.toFixed(2)));
    if(meses > 600) break; // para evitar loop infinito, max 50 anos
  }

  // Salvar dados no localStorage
  const dados = { valorMes, rendimento: rendimento*100, meta, meses, saldos };
  localStorage.setItem('investimentoDados', JSON.stringify(dados));

  // Mostrar resultado textual
  const anos = Math.floor(meses / 12);
  const mesesRest = meses % 12;
  document.getElementById('resultado').innerHTML = `
    <h3>Resultado da proje√ß√£o:</h3>
    <p>Voc√™ atingir√° uma renda mensal de R$ <b>${meta.toFixed(2)}</b> em aproximadamente <b>${anos} anos e ${mesesRest} meses</b>.</p>
    <p>Saldo acumulado estimado: R$ <b>${saldos[saldos.length - 1].toFixed(2)}</b></p>
  `;

  // Mostrar bot√£o WhatsApp
  document.getElementById('btnWhats').style.display = 'inline-block';

  // Criar gr√°fico (ou atualizar)
  if(chart) chart.destroy();
  chart = new Chart(ctx, {
    type: 'line',
    data: {
      labels,
      datasets: [{
        label: 'Saldo acumulado (R$)',
        data: saldos,
        borderColor: 'rgb(0, 123, 255)',
        fill: false,
        tension: 0.1
      }]
    },
    options: {
      scales: {
        y: { beginAtZero: true }
      }
    }
  });
}

function enviarWhatsApp() {
  const dados = JSON.parse(localStorage.getItem('investimentoDados'));
  if(!dados) {
    alert('Nenhum dado salvo para enviar.');
    return;
  }
  const msg = `üìä *Proje√ß√£o de Investimento*\n
Valor mensal: R$ ${dados.valorMes.toFixed(2)}
Rendimento mensal: ${dados.rendimento.toFixed(2)}%
Meta de renda mensal: R$ ${dados.meta.toFixed(2)}
Tempo estimado para atingir meta: ${Math.floor(dados.meses/12)} anos e ${dados.meses%12} meses
Saldo acumulado estimado: R$ ${dados.saldos[dados.saldos.length -1].toFixed(2)}
  
#Investimento #MetaFinanceira`;

  const url = `https://api.whatsapp.com/send?text=${encodeURIComponent(msg)}`;
  window.open(url, '_blank');
}

// Ao carregar a p√°gina tenta carregar dados salvos
window.onload = () => {
  const dados = localStorage.getItem('investimentoDados');
  if(dados) {
    const obj = JSON.parse(dados);
    document.getElementById('valorMes').value = obj.valorMes;
    document.getElementById('rendimento').value = obj.rendimento;
    document.getElementById('meta').value = obj.meta;
    calcular();
  }
};
</script>

</body>
</html>
